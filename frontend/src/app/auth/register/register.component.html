<app-auth>
  <h1>Register</h1>
  <form (ngSubmit)="submitForm()" class="form" [formGroup]="userInfos">
    <div class="input">
      <div class="input-with-icon">
        <fa-icon class="icon" [icon]="faAt"></fa-icon>
        <input type="email" placeholder="email" formControlName="email" required>
      </div>
      <div class="input-errors" *ngIf="submitted && userInfos.controls.email.errors">
        <div class="input-error" *ngIf="userInfos.controls.email.errors.pattern">Please enter a valid email</div>
        <div class="input-error" *ngIf="userInfos.controls.email.errors.required">This field is required</div>
        <div class="input-error" *ngIf="userInfos.controls.email.errors.taken">This email has already been used</div>
      </div>
    </div>
    <div class="input">
      <div class="input-with-icon">
        <fa-icon class="icon" [icon]="faUser"></fa-icon>
        <input type="text" placeholder="username" formControlName="username" required>
      </div>
      <div class="input-errors" *ngIf="submitted && userInfos.controls.username.errors">
        <div class="input-error" *ngIf="userInfos.controls.username.errors.required">This field is required</div>
        <div class="input-error" *ngIf="userInfos.controls.username.errors.taken">This username is already taken</div>
      </div>
    </div>
    <div class="input">
      <div class="input-with-icon">
        <fa-icon class="icon" [icon]="faKey"></fa-icon>
        <input type="password" placeholder="password" formControlName="password" required>
      </div>
      <div class="input-errors" *ngIf="submitted && userInfos.controls.password.errors">
        <div class="input-error" *ngIf="userInfos.controls.password.errors.required">This field is required</div>
      </div>
    </div>
    <div class="input">
      <div class="input-with-icon">
        <fa-icon class="icon" [icon]="faKey"></fa-icon>
        <input type="password" placeholder="confirm password" formControlName="password_confirmation" required>
      </div>
      <div class="input-errors" *ngIf="submitted && userInfos.controls.password_confirmation.errors">
        <div class="input-error" *ngIf="userInfos.controls.password_confirmation.errors.required">This field is required</div>
      </div>
    </div>

    <div class="errors" *ngIf="errors.length > 0">
      <div class="error" *ngFor="let error of errors">{{ error }}</div>
    </div>

    <div class="actions">
      <a routerLink="/login">Already have an account ? Log in</a>
      <button class="btn submit-button" [disabled]="waitingForResponse">
        <app-spinner *ngIf="waitingForResponse"></app-spinner>
        <span *ngIf="!waitingForResponse">Submit</span>
      </button>
    </div>
  </form>
</app-auth>
